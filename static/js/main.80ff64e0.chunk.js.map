{"version":3,"sources":["reportWebVitals.ts","DragDropOverlay.tsx","Constants.ts","Api.ts","SettingsOverlay.tsx","Util.ts","Compose.tsx","Log.tsx","Logs.tsx","PreviewImagesOverlay.tsx","NotificationBar.tsx","MainPage.tsx","index.tsx"],"names":["reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","DragDropOverlay","onDropFile","useState","drag","setDrag","file","setFile","useEffect","undefined","document","addEventListener","ev","preventDefault","dataTransfer","items","i","length","kind","getAsFile","files","console","log","name","fromElement","StyledMain","enabled","styled","div","x","zIndexes","localStorageKey","myUser","end_point","imageMaxSize","uploadImages","a","base64s","bindTextId","fileUploader","base64","Error","params","bind_text_id","fetch","method","headers","Authorization","body","JSON","stringify","res","json","Promise","all","Array","from","map","httpToJson","ok","text","SettingsOverlay","open","onClose","description","state","update","userMap","useContext","ImageMapContext","apply","value","Object","entries","id","dummyMyUser","_user_id","myUserValue","e","key","localStorageMyUser","localStorage","getItem","parse","setItem","StyledBackground","StyledImageOverlay","StyledHeaderContainer","className","icon","faTimesCircle","onClick","StyledForm","htmlFor","type","onChange","prev","target","cols","rows","asyncConvertBase64","result","r","fr","FileReader","onload","readAsDataURL","error","Compose","onSubmit","userList","sendStatus","setSendStatus","settingsOverlayOpen","setSettingsOverlayOpen","setNotificationContent","inputRef","useRef","handleKeyup","useCallback","ctrlKey","handleDropFile","trim","initialComposeValue","current","removeEventListener","handleChangeComposeValue","event","loading","placeholder","replyToTextId","disabled","replyToUserId","user","slice","StyledTextCounter","ref","faPaperPlane","title","index","filter","_","faCog","form","Log","Number","MIN_SAFE_INTEGER","updateTimeTrigger","setUpdateTimeTrigger","replyDestination","setReplyDestination","likeCount","setLikeCount","ComposeContext","composeValue","setComposeValue","imageMap","likeMap","loadImages","LoadImagesContext","setPreviewImages","SetPreviewImagesContext","time","useMemo","now","Date","date","_created_at","diff","getTime","timeDiff","Math","floor","localizedTime","toLocaleString","setInterval","like_count","getUser","userId","handleClickFavorite","textId","catch","err","response","status","like","nextLikeCount","handleChangeImageFile","handleClickReply","in_reply_to_text_id","StyledMeta","dateTime","StyledReplyTo","in_reply_to_user_id","StyledText","image","StyledImg","src","alt","images","faReply","faHeart","faImages","accept","multiple","hidden","StyledReplyDestinationText","y","img","Logs","onChangePainValue","loadLogTrigger","texts","setTexts","limit","setLimit","pollingIntervalTime","setPollingIntervalTime","editingPainValue","setEditingPainValue","internalLoadLogTrigger","setInternalLoadLogTrigger","openTitle","setOpenTitle","titleHeight","clearInterval","query","StyledLogs","StyledLogsTitle","StyledTitleHeader","onBlur","StyledTexts","PreviewImagesOverlay","viewingIndex","setViewingIndex","imageSize","setImageSize","keyup","setKeyup","offsetX","setOffsetX","imgElementRef","max","min","imageSrc","complete","width","naturalWidth","height","naturalHeight","getElementsByTagName","style","overflow","window","pageXOffset","left","StyledPoints","StyledPoint","NotificationTypeTable","notification","warning","NotificationBar","content","notificationMessages","setNotificationMessages","counter","setCounter","toString","setTimeout","p","StyledMain2","notificationMessage","v","createContext","MainPage","setUserList","imageList","setImageList","likeList","setLikeList","setLoadLogTrigger","previewImages","openPreviewImagesOverlay","setOpenPreviewImagesOverlay","notificationContent","encodeURI","painValues","setPainValues","reduce","acc","cur","loadUser","loadImagesLimit","newImageList","newImageListIndex","findIndex","newImage","loadLikes","handleSubmit","postTextRes","Provider","list","newList","ReactDOM","render","StrictMode","exact","path","getElementById"],"mappings":"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","file":"static/js/main.80ff64e0.chunk.js","sourcesContent":["import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import styled from \"styled-components\";\nimport {useEffect, useState} from \"react\";\n\nexport const DragDropOverlay = ({onDropFile}:{onDropFile: (file: File) => void}) => {\n  const [drag, setDrag] = useState(false);\n  // addEventListenerを都度貼り替えるのが面倒なため、state経由でuseEffectを発火させ、onDropFileさせる\n  const [file, setFile] = useState<File | undefined>();\n\n  useEffect(() => {\n    if(file){\n      onDropFile(file);\n      setFile(undefined);\n    }\n  }, [file, onDropFile]);\n\n  useEffect(() => {\n    const handleDrop =  (ev: any) => {\n      setDrag(false);\n      ev.preventDefault();\n\n      if (ev.dataTransfer.items) {\n        // Use DataTransferItemList interface to access the file(s)\n        for (let i = 0; i < ev.dataTransfer.items.length; i++) {\n          // If dropped items aren't files, reject them\n          if (ev.dataTransfer.items[i].kind === 'file') {\n            const file = ev.dataTransfer.items[i].getAsFile();\n            setFile(file);\n          }\n        }\n      } else {\n        // Use DataTransfer interface to access the file(s)\n        for (let i = 0; i < ev.dataTransfer.files.length; i++) {\n          console.log('... file[' + i + '].name = ' + ev.dataTransfer.files[i].name);\n        }\n      }\n    };\n\n    const dragEnterHandler = (ev: any) =>  {\n      ev.preventDefault();\n      setDrag(true);\n    };\n\n    const dragOverHandler = (ev: any) =>  ev.preventDefault();\n\n    const handleDragLeave = (ev: any) =>  {\n      ev.preventDefault();\n      console.log('leave', ev);\n      if (!ev.fromElement){\n        setDrag(false);\n      }\n    };\n\n    document.addEventListener('drop', handleDrop);\n    document.addEventListener('dragenter', dragEnterHandler);\n    document.addEventListener('dragover', dragOverHandler);//kesu nokosu\n    document.addEventListener('dragleave', handleDragLeave);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <StyledMain enabled={drag} />\n  );\n};\n\nconst styledDragDropOverlayMargin = 16;\nconst styledDragDropOverlayBorderSize = 4;\n\nconst StyledMain = styled.div<{enabled: boolean}>`\n  position: absolute;\n  width: calc(100vw - ${(styledDragDropOverlayMargin + styledDragDropOverlayBorderSize) * 2}px);\n  height: calc(100vh - ${(styledDragDropOverlayMargin + styledDragDropOverlayBorderSize) * 2}px);\n  top: 0px;\n  margin: ${styledDragDropOverlayMargin}px;\n  border-radius: 32px;\n  background: gray;\n  border: ${styledDragDropOverlayBorderSize}px dashed black;\n  opacity: 0.5;\n  display:   ${(x) =>  x.enabled ? 'block' : 'none'};\n`;\n","export const zIndexes = {\n  dragDrop: 100,\n  previewImages: 300,\n  previewImagesBackground: 200,\n  settings: 250,\n  notificationBar: 500,\n};\n\nconst appName = 'SNSClientForEngineersAndProgrammers';\n\nexport const localStorageKey = {\n  myUser: `${appName}_myUser`,\n};\n","export const end_point = \"https://versatileapi.herokuapp.com/api\";\n\ntype Base = {\n  id: string;\n  _created_at: string;\n  _updated_at: string;\n  _user_id: string;\n}\n\nexport type Text = Base & {\n  text: string;\n  in_reply_to_user_id?: string; //返信対象のUserId\n  in_reply_to_text_id?: string; //返信対象のTextId\n}\n\nexport type Image = Base & {\n  base64: string;\n  bind_text_id: string;\n}\n\nexport type User = Base & {\n  description: string;\n  name: string;\n}\n\nexport type Like = {\n  id: string;\n  _updated_at: string;\n  like_count: number;\n}\n\nexport type Return = {\n  id: string;\n}\n\nexport const imageMaxSize = 100_000;\n\nexport const uploadImages = async ({base64s, bindTextId}:{base64s: string[], bindTextId: string}) => {\n  const fileUploader = async (base64: string) => {\n\n    if (base64.length > imageMaxSize) throw new Error();\n    const params = {\n      base64,\n      bind_text_id: bindTextId,\n    }\n    await fetch(`${end_point}/image`, {\n      method: \"POST\",\n      headers: {Authorization: \"evolution\"},\n      body: JSON.stringify(params),\n    }).then((res) => res.json()).then(x => console.log(x));\n  };\n\n  await Promise.all(Array.from(base64s).map(fileUploader));\n};\n\nexport const httpToJson = (res: Response) => res.ok ? res.json() : res.text();","import styled from \"styled-components\";\nimport React, {useContext, useEffect, useState} from \"react\";\nimport {localStorageKey, zIndexes} from \"./Constants\";\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\nimport {end_point, httpToJson, Return, User} from \"./Api\";\nimport {ImageMapContext} from \"./MainPage\";\n\ntype State = {\n  name: string,\n  description: string,\n};\n\nexport const SettingsOverlay = ({open, onClose}: {open: boolean; onClose: () => void}) => {\n  const [state, update] = useState<State>({\n    name: '',\n    description: '',\n  });\n\n  const { userMap } = useContext(ImageMapContext);\n\n  const apply = async (value: State) => {\n    return await fetch(`${end_point}/user/create_user`, {\n      method: \"POST\",\n      headers: {Authorization: \"HelloWorld\"},\n      body: JSON.stringify(value)\n    }).then(httpToJson);\n  };\n\n  const handleClose = () => {\n    apply(state);\n    onClose();\n  };\n\n  useEffect(() => {\n    (async () => {\n      // ユーザー情報のサーバーからの取得（localStorageから取得できなかったときに発動）\n      if(!Object.entries(userMap).length) return;\n\n      // localStorageから取得できてれば、ここを通らない。\n      if(state.name || state.description) return;\n\n      const res: Return = await apply({name: '', description: ''});\n      const dummyMyUser: User = await fetch(`${end_point}/user/${res.id}`, {\n        headers: {Authorization: \"HelloWorld\"},\n      }).then(httpToJson);\n\n      const myUser = userMap[dummyMyUser._user_id];\n      if(!myUser) return;\n\n      const myUserValue = {\n        name: myUser.name,\n        description: myUser.description,\n      };\n      update(myUserValue);\n      await apply(myUserValue);\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userMap]);\n\n  useEffect(() => {\n    const handleKeyup = (e: KeyboardEvent) => {\n      e.preventDefault();\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n    document.addEventListener('keyup', handleKeyup, false);\n\n    // ユーザー初期値\n    const localStorageMyUser = localStorage.getItem(localStorageKey.myUser);\n    if (localStorageMyUser) {\n      update(JSON.parse(localStorageMyUser));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if(!state.name) return;\n    if(!state.description) return;\n\n    localStorage.setItem(localStorageKey.myUser, JSON.stringify(state));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state]);\n\n  return (\n    <>\n      {open ?\n        <StyledMain enabled={open} >\n          <StyledBackground />\n          <StyledImageOverlay>\n            <StyledHeaderContainer>\n              <div>Settings</div>\n              <FontAwesomeIcon className=\"clickable ml1\" icon={faTimesCircle} onClick={handleClose}/>\n            </StyledHeaderContainer>\n            <StyledForm>\n              <div>\n                <label htmlFor=\"SettingsOverlay_name\">name</label>\n                <input\n                  name=\"name\"\n                  id=\"SettingsOverlay_name\"\n                  type=\"text\"\n                  value={state.name}\n                  onChange={e => {\n                    update(prev => ({...prev, name: e.target.value}));\n                  }}\n                />\n              </div>\n              <div>\n                <label htmlFor=\"SettingsOverlay_description\">description</label>\n                <textarea\n                  name=\"description\"\n                  id=\"SettingsOverlay_description\"\n                  cols={30}\n                  rows={5}\n                  value={state.description}\n                  onChange={e => {\n                    update(prev => ({...prev, description: e.target.value}));\n                  }}\n                />\n              </div>\n            </StyledForm>\n          </StyledImageOverlay>\n        </StyledMain> : null\n      }\n    </>\n  );\n};\n\nconst StyledMain = styled.div<{enabled: boolean}>`\n  position: absolute;\n  top: 0px;\n  z-index: 300;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  height: 100vh;\n  align-items: center;\n`;\n\nconst StyledBackground = styled.div`\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: ${zIndexes.previewImagesBackground};\n  top: 0px;\n  background: gray;\n  opacity: 0.5;\n`;\n\nconst StyledImageOverlay = styled.div`\n  z-index: ${zIndexes.settings};\n  background: white;\n  padding: 16px;\n  border-radius: 8px;\n`;\n\nconst StyledHeaderContainer = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n`;\n\nconst StyledForm = styled.div`\n  & label {\n    display: block;\n    margin-top: 8px;\n  }\n`;\n","import {imageMaxSize} from \"./Api\";\n\nexport const asyncConvertBase64 = async (file: File) => {\n  const result = new Promise((r) => {\n    const fr = new FileReader();\n    fr.onload = (e) => {\n      r(e.target?.result);\n    };\n    fr.readAsDataURL(file);\n  });\n  const base64 = (await result) as any as string;\n  if (base64.length > imageMaxSize) {\n    console.error(`base64 size is ${base64.length}`);\n    return null\n  }\n  return base64;\n}\n","import React, {useCallback, useContext, useEffect, useRef, useState} from \"react\";\nimport { User } from \"./Api\";\nimport {ComposeValue, ImageMapContext, initialComposeValue} from \"./MainPage\";\nimport {faCog, faPaperPlane, faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport styled from \"styled-components\";\nimport { DragDropOverlay } from \"./DragDropOverlay\";\nimport {SettingsOverlay} from \"./SettingsOverlay\";\nimport {asyncConvertBase64} from \"./Util\";\n\nexport const composeHeight = 100;\n\nexport const Compose = ({\n  value,\n  onChange,\n  onSubmit,\n  userList\n}: {\n  value: ComposeValue,\n  onChange: (value: ComposeValue) => void,\n  onSubmit: (value: ComposeValue) => void;\n  userList: User[]\n}) => {\n  const [sendStatus, setSendStatus] = useState<'waiting' | 'send' | 'sending'>('waiting');\n  const [settingsOverlayOpen, setSettingsOverlayOpen] = useState(false);\n\n  const { setNotificationContent } =  useContext(ImageMapContext);\n\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n\n  const handleKeyup = useCallback((e: KeyboardEvent) => {\n    // Ctrl + Enterで送信\n    if (e.ctrlKey && e.key === 'Enter' && sendStatus === 'waiting') {\n      // ここで送信処理はせず、sendフラグの変更をuseEffectで察知させて、送ることで、古いデータを送らないようにする\n      setSendStatus('send');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleDropFile = async (file: File) => {\n    const base64 = await asyncConvertBase64(file);\n    if (!base64) {\n      console.error('画像が大きすぎます');\n      setNotificationContent({text: '画像が大きすぎます', type: \"error\"});\n      return;\n    }\n    onChange({...value, files: [...(value.files || []), file]});\n  };\n\n  useEffect(() => {\n    (async () => {\n      if (sendStatus === 'send' && value.text.trim()) {\n        // 他と競合して、同時に発火するのを防ぐため、一番先に実行されたものはステータスを変更しておく。\n        setSendStatus('sending');\n        try {\n          await onSubmit(value);\n          onChange(initialComposeValue);\n        } catch (e) {\n          setNotificationContent({text: 'エラー発生'});\n          console.error(e);\n        } finally {\n          setSendStatus('waiting');\n        }\n      }\n    })();\n  }, [sendStatus, value, onChange, onSubmit, setNotificationContent]);\n\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.removeEventListener(\"keyup\", handleKeyup, false);\n      inputRef.current.addEventListener(\"keyup\", handleKeyup, false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [inputRef.current]);\n\n  const handleChangeComposeValue = (event: any) => {\n    onChange({\n      ...value,\n      [event.target.name]: event.target.value,\n    });\n  };\n\n  const loading = sendStatus !== 'waiting';\n\n  return (\n    <StyledMain>\n      <StyledForm>\n        <div className=\"flex\">\n          <input\n            type=\"text\"\n            name=\"replyToTextId\"\n            placeholder=\"ツイートへの返信\"\n            value={value.replyToTextId}\n            onChange={handleChangeComposeValue}\n            disabled={loading}\n          />\n          <select\n            name=\"replyToUserId\"\n            value={value.replyToUserId}\n            onChange={handleChangeComposeValue}\n            disabled={loading}\n          >\n            <option value=\"\">-</option>\n            {userList.map(user => (\n              <option key={user.id} value={user.id}>\n                {user.name || `匿名(${user._user_id.slice(0, 2)})`}\n              </option>\n            ))}\n          </select>\n          <StyledTextCounter error={value.text.trim().length > 280}>\n            {`${value.text.trim().length}/280`}\n          </StyledTextCounter>\n        </div>\n        <div className=\"flex\">\n          <textarea\n            name=\"text\"\n            ref={inputRef}\n            placeholder=\"今なにしてる？\"\n            rows={4}\n            cols={50}\n            value={value.text}\n            onChange={e => onChange({...value, text: e.target.value})}\n            disabled={loading}\n          />\n          <FontAwesomeIcon\n            className={!loading ? 'clickable' : ''}\n            icon={faPaperPlane}\n            title=\"post\"\n            onClick={(e) => {e.preventDefault();!loading && setSendStatus('send');}}\n          />\n          <div>\n            {value.files?.map((file, index) => (\n              <div>\n                {file.name}\n                <FontAwesomeIcon\n                  className=\"clickable ml1\"\n                  icon={faTimesCircle}\n                  onClick={() => onChange({...value, files: value.files?.filter((_, i) => i !== index)})}\n                />\n              </div>\n            ))}\n          </div>\n        </div>\n      </StyledForm>\n      <FontAwesomeIcon className=\"clickable ml1\" icon={faCog} onClick={() => setSettingsOverlayOpen(true)}/>\n      <SettingsOverlay open={settingsOverlayOpen} onClose={() => setSettingsOverlayOpen(false)}/>\n      <DragDropOverlay onDropFile={handleDropFile}/>\n    </StyledMain>\n  );\n};\n\nconst StyledMain = styled.div`\n  height: ${composeHeight}px;\n  display: flex;\n`;\n\nconst StyledForm = styled.form`\n  width: 500px;\n`;\n\nconst StyledTextCounter = styled.div<{error: boolean}>`\n  color: ${(x) => x.error ? 'red': 'black'};\n`;\n","import React, { ChangeEvent, useContext, useEffect, useMemo } from 'react';\nimport { useState } from \"react\";\nimport {Text, end_point, uploadImages, Like, httpToJson} from \"./Api\";\nimport {faHeart, faImages, faReply, faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport './index.css';\nimport styled from \"styled-components\";\nimport {\n  ComposeContext,\n  ImageMapContext,\n  LoadImagesContext,\n  SetPreviewImagesContext\n} from \"./MainPage\";\nimport {asyncConvertBase64} from \"./Util\";\n\nexport const Log = ({\n  text,\n  onClose,\n}: {\n  text: Text;\n  onClose?: () => void\n}) => {\n  const [updateTimeTrigger, setUpdateTimeTrigger] = useState(Number.MIN_SAFE_INTEGER);\n  const [replyDestination, setReplyDestination] = useState<{\n    text?: Text;\n    open: boolean;\n  }>({open: false});\n  const [likeCount, setLikeCount] = useState(0);\n\n  const { composeValue, setComposeValue } = useContext(ComposeContext);\n  const {imageMap, likeMap, userMap, setNotificationContent} = useContext(ImageMapContext);\n  const loadImages = useContext(LoadImagesContext);\n  const setPreviewImages = useContext(SetPreviewImagesContext);\n\n  const time = useMemo(() => {\n    const now = new Date();\n    const date = new Date(text._created_at);\n    const diff = (now.getTime() - date.getTime()) / 1_000;\n    let timeDiff = \"\";\n    if (diff < 60) {\n      timeDiff = `${Math.floor(diff)}秒前`;\n    } else if (diff / 60 < 60) {\n      timeDiff = `${Math.floor(diff / 60)}分前`;\n    } else if (diff / 60 / 60 < 24) {\n      timeDiff = `${Math.floor(diff / 60 / 60)}時間前`;\n    } else {\n      timeDiff = `${Math.floor(diff / 60 / 60 / 24)}日前`;\n    }\n    return {\n      timeDiff,\n      time: text._created_at,\n      localizedTime: date.toLocaleString(\"ja-JP\"),\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [text, userMap, updateTimeTrigger]);\n\n  useEffect(() => {\n    setInterval(() => setUpdateTimeTrigger(prev => prev + 1), 5_000);\n  }, []);\n\n  useEffect(() => {\n    setLikeCount(likeMap[text.id]?.like_count || 0);\n  }, [likeMap, text.id]);\n\n  const getUser = (userId: string) => {\n    return userMap[userId]?.name || `匿名(${userId.slice(0, 2)})`;\n  };\n\n  const handleReplyTo = (x: { textId: string, userId: string }) => {\n    setComposeValue({...composeValue, replyToTextId: x.textId,  replyToUserId: x.userId})\n  };\n\n  const handleClickFavorite = async ({textId}: { textId: string }) => {\n    const like: Like | undefined = await fetch(`${end_point}/like/${textId}`)\n      .then(httpToJson).catch(err => {\n        if (err?.response?.status === 404) {\n          // 0件なので無視\n        } else {\n          throw err;\n        }\n      });\n\n    const nextLikeCount = (like?.like_count || 0) + 1;\n    const params = {\n      like_count: nextLikeCount\n    };\n    await fetch(`${end_point}/like/${textId}`, {\n      method: \"PUT\",\n      headers: {Authorization: \"LOVE\"},\n      body: JSON.stringify(params),\n    }).then((res) => res.json())\n      .then((_) => {\n        setLikeCount(nextLikeCount);\n      });\n  };\n\n  const handleChangeImageFile = async (e: ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files) return;\n\n    for(const file of Array.from(e.target.files)){\n      const base64 = await asyncConvertBase64(file);\n      if(!base64) {\n        console.error('画像が大きすぎます');\n        setNotificationContent({text: '画像が大きすぎます', type: \"error\"})\n        continue;\n      }\n      await uploadImages({base64s: [base64], bindTextId: text.id});\n    }\n\n    loadImages();\n  };\n\n  const handleClickReply = async () => {\n      if(!text.in_reply_to_text_id) return;\n\n      if(replyDestination.text){\n        setReplyDestination(prev => ({\n          ...prev,\n          open: true,\n        }))\n        return;\n      }\n      await fetch(`${end_point}/text/${text.in_reply_to_text_id}`)\n        .then((res) => (res.json()))\n        .then(x => {\n          setReplyDestination({\n            text: x,\n            open: true,\n          })\n        });\n    };\n\n  return (\n    <StyledMain>\n      <StyledMeta>\n        <div\n          title={userMap[text._user_id]?.description || text._user_id}>\n          {getUser(text._user_id)}\n        </div>\n        <div>\n          <time dateTime={time.time} title={time.localizedTime}>\n            {time.timeDiff}\n          </time>\n          {onClose ?\n            <FontAwesomeIcon className=\"clickable ml1\" icon={faTimesCircle} onClick={onClose}/>\n            : null\n          }\n        </div>\n      </StyledMeta>\n      <div>\n        <StyledReplyTo onClick={handleClickReply} >\n          {text.in_reply_to_text_id ? `To: ${text.in_reply_to_text_id} `: ''}\n        </StyledReplyTo>\n        <div>\n          {text.in_reply_to_user_id ? `@${getUser(text.in_reply_to_user_id)} `: ''}\n        </div>\n        <StyledText>\n          {text.text}\n        </StyledText>\n      </div>\n      {imageMap[text.id]?.length ?\n        imageMap[text.id].map((image, index) => (\n          <div key={image.id}>\n            <StyledImg\n              className=\"clickable\"\n              src={image.base64}\n              alt={`${getUser(text._user_id)}さんが貼り付けた画像`}\n              title={`${getUser(image._user_id)}さんが貼り付けた画像`}\n              onClick={() => setPreviewImages({images: imageMap[text.id].map(x => x.base64), index})}\n            />\n          </div>\n        ))\n        : null\n      }\n      <div className=\"flex mt1\">\n        <FontAwesomeIcon\n          className=\"clickable\"\n          icon={faReply}\n          title=\"reply\"\n          onClick={() => handleReplyTo({textId: text.id, userId: text._user_id})}\n        />\n        <FontAwesomeIcon\n          className=\"clickable ml2\"\n          icon={faHeart}\n          title=\"favorite\"\n          onClick={() => handleClickFavorite({textId: text.id})}\n        />\n        {likeCount}\n        <label htmlFor={`image_upload_${text.id}`}>\n          <FontAwesomeIcon\n            className=\"clickable ml2\"\n            icon={faImages}\n            title=\"images\"\n          />\n          <input\n            id={`image_upload_${text.id}`}\n            type=\"file\"\n            accept=\"image/*\"\n            multiple\n            hidden\n            onChange={handleChangeImageFile}\n          />\n        </label>\n      </div>\n      {\n        replyDestination.open && replyDestination.text?\n          (\n            <StyledReplyDestinationText\n              x={onClose ? 0 : 8}\n              y={16}\n            >\n              <Log\n                text={replyDestination.text}\n                onClose={() => setReplyDestination(prev => ({...prev, open: false}))}\n              />\n            </StyledReplyDestinationText>\n          )\n          : null\n      }\n    </StyledMain>\n  );\n};\n\nconst StyledMain = styled.div`\n  border: 1px solid #ccc;\n  padding: 8px;\n`;\n\nconst StyledMeta = styled.div`\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst StyledReplyTo = styled.div`\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n`;\n\nconst StyledText = styled.div`\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  padding-top: 2px;\n`;\n\nconst StyledImg = styled.img`\n  width: 100%;\n`;\n\nconst StyledReplyDestinationText = styled.div<{x: number, y: number}>`\n  margin-left: ${({x}) => x}px;\n  margin-top: ${({y}) => y}px;\n`;\n","import {end_point, httpToJson, Text} from \"./Api\";\nimport React, {useEffect, useState} from \"react\";\nimport {Log} from \"./Log\";\nimport styled from \"styled-components\";\nimport {composeHeight} from \"./Compose\";\nimport {PainValue} from \"./MainPage\";\n\nconst titleHeaderHeight = 22;\n\nexport const Logs = ({\n  value,\n  onChangePainValue,\n  loadLogTrigger,\n} : {\n  value: PainValue,\n  onChangePainValue: (value: PainValue) => void,\n  loadLogTrigger?: number,\n}) => {\n  const [texts, setTexts] = useState<Text[]>([]);\n  const [limit, setLimit] = useState(20);\n  const [pollingIntervalTime, setPollingIntervalTime] = useState(20);\n  const [editingPainValue, setEditingPainValue] = useState(value);\n  // Logs個別のトリガー\n  const [internalLoadLogTrigger, setInternalLoadLogTrigger] = useState(Number.MIN_SAFE_INTEGER);\n  const [openTitle, setOpenTitle] = useState(false);\n\n  const titleHeight = (openTitle ? 300 : 0 ) + titleHeaderHeight;\n\n  const loadLog = () => {\n    fetch(`${end_point}/text/all?${value.query}&$limit=${limit}`)\n      .then(httpToJson)\n      .then(setTexts).catch(console.error);\n  };\n\n  const handleClickLoadMore = () => {\n    setLimit(prev => prev + 20);\n  };\n\n  useEffect(() => {\n    const id = setInterval(() => setInternalLoadLogTrigger(prev => prev + 1), pollingIntervalTime * 1_000);\n\n    return () => clearInterval(id);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pollingIntervalTime]);\n\n  useEffect(() => loadLog(),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [loadLogTrigger, internalLoadLogTrigger, limit]);\n\n  useEffect(() => setEditingPainValue(value),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [value]);\n\n  return (\n    <StyledLogs>\n      <StyledLogsTitle\n        titleHeight={titleHeight}\n      >\n        <StyledTitleHeader\n          className=\"clickable\"\n          onClick={() => {\n            setOpenTitle(prev => !prev);\n          }}\n        >\n          {value.name}\n        </StyledTitleHeader>\n        <StyledForm className=\"p2\">\n          <div>\n            <label htmlFor=\"Logs_name\">name</label>\n            <input\n              name=\"name\"\n              id=\"Logs_name\"\n              type=\"text\"\n              value={editingPainValue.name}\n              onChange={e => {\n                setEditingPainValue(prev => ({...prev, name: e.target.value}));\n              }}\n              onBlur={() => onChangePainValue(editingPainValue)}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"Logs_query\">query</label>\n            <textarea\n              name=\"query\"\n              id=\"Logs_query\"\n              cols={30}\n              rows={5}\n              value={editingPainValue.query}\n              onChange={e => {\n                setEditingPainValue(prev => ({...prev, query: e.target.value}));\n              }}\n              onBlur={() => onChangePainValue(editingPainValue)}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"Logs_limit\">limit</label>\n            <input\n              name=\"limit\"\n              id=\"Logs_limit\"\n              type=\"number\"\n              value={limit}\n              onChange={e => setLimit(Number(e.target.value))}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"Logs_polling_interval_time\">polling interval time</label>\n            <input\n              name=\"polling_interval_time\"\n              id=\"Logs_polling_interval_time\"\n              type=\"number\"\n              value={pollingIntervalTime}\n              onChange={e => setPollingIntervalTime(Number(e.target.value))}\n            />\n          </div>\n        </StyledForm>\n      </StyledLogsTitle>\n      <StyledTexts titleHeight={titleHeight}>\n        {texts.map(text => (\n          <Log\n            key={text.id}\n            text={text}\n          />\n        ))}\n        <div className=\"clickable\" onClick={handleClickLoadMore}>load more</div>\n      </StyledTexts>\n    </StyledLogs>\n  );\n}\n\nconst StyledLogs = styled.div`\n  width: 320px;\n`;\n\nconst StyledLogsTitle = styled.div<{titleHeight: number}>`\n  height: ${(x) => x.titleHeight}px;\n  overflow: hidden;\n  transition: all 300ms 0s ease;\n`;\n\nconst StyledTitleHeader = styled.div`\n  height: ${titleHeaderHeight}px;\n`;\n\nconst StyledForm = styled.div`\n  & label {\n    display: block;\n    margin-top: 8px;\n  }\n`;\n\nconst StyledTexts = styled.div<{titleHeight: number}>`\n  height: calc(100vh - ${(x) => composeHeight + x.titleHeight}px);\n  overflow-y: auto;\n`;\n","import styled from \"styled-components\";\nimport {useEffect, useRef, useState} from \"react\";\nimport {zIndexes} from \"./Constants\";\n\nexport const PreviewImagesOverlay = ({open, onClose, images, index}: {open: boolean; onClose: () => void; images: string[], index: number}) => {\n  const [viewingIndex, setViewingIndex] = useState(index);\n  const [imageSize, setImageSize] = useState<{width: number, height: number} | undefined>();\n  const [keyup, setKeyup] = useState<string | undefined>();\n  const [offsetX, setOffsetX] = useState<number>(0);\n  const imgElementRef = useRef<HTMLImageElement>(null);\n\n  useEffect(() => {\n    setViewingIndex(index);\n  }, [index]);\n\n  useEffect(() => {\n    if (keyup === 'Escape') {\n      onClose();\n    } else if (keyup === 'ArrowLeft') {\n      setViewingIndex(prev => Math.max(prev - 1, 0));\n    } else if (keyup === 'ArrowRight') {\n      setViewingIndex(prev => Math.min(prev + 1, images.length - 1));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [keyup, setViewingIndex]);\n\n  useEffect(() => {\n    const handleKeyup = (e: KeyboardEvent) => {\n      e.preventDefault();\n      setKeyup(e.key);\n    };\n    document.addEventListener('keyup', handleKeyup, false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const imageSrc = images[viewingIndex];\n\n  useEffect(() => {\n    if(imgElementRef.current && imgElementRef.current.complete ){\n      setImageSize({\n        width: imgElementRef.current.naturalWidth,\n        height: imgElementRef.current.naturalHeight,\n      });\n    } else {\n      setImageSize(undefined);\n    }\n  }, [imageSrc, imgElementRef.current?.complete]);\n\n  useEffect(() => {\n    const bodyElement = document.getElementsByTagName('body')[0];\n    bodyElement.style.overflow = open ? 'hidden' : 'initial';\n    if(open){\n      setOffsetX(window.pageXOffset);\n    }\n  }, [open]);\n\n  return (\n    <>\n      {open ?\n        <StyledMain left={offsetX}>\n          <StyledBackground onClick={() => onClose()} />\n          <StyledImageOverlay>\n            <img ref={imgElementRef} src={imageSrc} {...imageSize}  alt=\"画像\" />\n            {images.length > 0 &&\n              <StyledPoints>\n                {[...Array(images.length)].map((_, i) => (\n                  <StyledPoint key={i} current={i === viewingIndex} />\n                ))}\n              </StyledPoints>\n            }\n          </StyledImageOverlay>\n        </StyledMain>\n        : null\n      }\n    </>\n  );\n};\n\nconst StyledMain = styled.div<{left: number}>`\n  position: absolute;\n  top: 0px;\n  z-index: 300;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  height: 100vh;\n  align-items: center;\n  left: ${(x) => x.left}px;\n`;\n\nconst StyledBackground = styled.div`\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  z-index: ${zIndexes.previewImagesBackground};\n  top: 0px;\n  background: gray;\n  opacity: 0.5;\n`;\n\nconst StyledImageOverlay = styled.div`\n  z-index: ${zIndexes.previewImages};\n`;\n\nconst StyledPoints = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\nconst StyledPoint = styled.div<{current: boolean}>`\n  height: 30px;\n  width: 12px;\n  color: ${(x) => x.current ? 'black' : '#ccc'};\n  ::after {\n    content: '●';\n  }\n`;\n","import styled from \"styled-components\";\nimport { useEffect, useState } from \"react\";\nimport { zIndexes } from \"./Constants\";\n\nexport type NotificationContent = { text: string, type?: NotificationType };\n\ntype NotificationType = 'notification' | 'warning'  | 'error';\nconst NotificationTypeTable: Record<NotificationType, string> = {\n  notification : 'black',\n  warning: 'FFA500',\n  error: 'red',\n}\n\nconst notificationTypeMapping: (value?: NotificationType) => string = v => NotificationTypeTable[v || 'notification'];\n\ntype Props = { content?: NotificationContent };\n\nexport const NotificationBar = ({content}: Props) => {\n  const [notificationMessages, setNotificationMessages] = useState<({ id: string; content: NotificationContent })[]>([]);\n  const [counter, setCounter] = useState(Number.MIN_SAFE_INTEGER);\n\n  useEffect(() => {\n    if(!content) return;\n\n    const id = counter.toString();\n    setNotificationMessages(prev => [...prev, {...{content}, id}]);\n\n    setTimeout(() => {\n      setNotificationMessages(prev => prev.filter(x => x.id !== id));\n    }, 50_000);\n    setCounter(p => p + 1);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [content]);\n\n  return (\n    <StyledMain2>\n      {notificationMessages.map((notificationMessage, index) => (\n        <StyledMain key={notificationMessage.id} type={notificationMessage.content?.type} >\n          {notificationMessage.content.text}\n        </StyledMain>\n      ))}\n    </StyledMain2>\n  );\n};\n\nconst StyledMain2 = styled.div`\n  position: absolute;\n  bottom: 50px;\n  left: 40px;\n`;\n\nconst StyledMain = styled.div<{type?: NotificationType}>`\n  z-index: ${zIndexes.notificationBar};\n  background: ${x => notificationTypeMapping(x.type)};\n  color: white;\n  border-radius: 10px;\n  margin-top: 16px;\n  padding: 8px 16px;\n  color: white;\n`;\n","import React, { createContext, useEffect, useMemo } from 'react';\nimport { useState } from \"react\";\nimport { Compose } from \"./Compose\";\nimport {end_point, User, Image, uploadImages, Return, Like, httpToJson} from \"./Api\";\nimport './index.css';\nimport styled from \"styled-components\";\nimport {Logs} from \"./Logs\";\nimport {PreviewImagesOverlay} from \"./PreviewImagesOverlay\";\nimport {NotificationBar, NotificationContent} from \"./NotificationBar\";\nimport {asyncConvertBase64} from \"./Util\";\n\nexport type ComposeValue = { text: string, replyToTextId: string, replyToUserId: string; files?: File[]}\n\nexport const initialComposeValue: ComposeValue = {text: \"\", replyToTextId: \"\", replyToUserId: \"\"};\n\nexport const ComposeContext =\n  createContext<{ composeValue: ComposeValue, setComposeValue: (value: ComposeValue) => void }>(\n    {composeValue: initialComposeValue, setComposeValue: (_: ComposeValue) => {}}\n  );\n\n// TODO rename\nexport const ImageMapContext = createContext<{\n  imageMap: Record<string, Image[]>,\n  likeMap: Record<string, Like>,\n  userMap: Record<string, User>,\n  setNotificationContent: (value: NotificationContent) => void,\n}>({\n  imageMap: {},\n  likeMap: {},\n  userMap: {},\n  setNotificationContent: (_: NotificationContent) => {},\n});\n\nexport const LoadImagesContext = createContext<() => void>(() => {});\n\nexport const SetPreviewImagesContext = createContext<(params: {images: string[], index: number}) => void>(() => {});\n\nexport type PainValue = {\n  name: string;\n  query: string;\n};\n\nexport const MainPage = () => {\n  const [userList, setUserList] = useState<User[]>([]);\n  const [imageList, setImageList] = useState<Image[]>([]);\n  const [likeList, setLikeList] = useState<Like[]>([]);\n  const [composeValue, setComposeValue] = useState<ComposeValue>(initialComposeValue);\n  const [loadLogTrigger, setLoadLogTrigger] = useState(Number.MIN_SAFE_INTEGER);\n  const [previewImages, setPreviewImages] = useState<{images: string[], index: number}>({images: [], index: 0});\n  const [openPreviewImagesOverlay, setOpenPreviewImagesOverlay] = useState(false);\n  const [notificationContent, setNotificationContent] = useState<NotificationContent>();\n  // TODO: localstorage?\n  const [painValues, setPainValues] = useState<PainValue[]>( [\n    {\n      name: 'All',\n      query: encodeURI(\"$filter=_user_id ne 'd9ecf9245defb6b07cb86fe92a6fde9e735fc9f9'&$orderby=_created_at desc\"),\n    },\n    {\n      name: 'To me',\n      query: encodeURI(\"$filter=in_reply_to_user_id eq '57039384a74e1fed39b1663b460b7e7f51f99bee'&$orderby=_created_at desc\")\n    },\n    {\n      name: 'Self',\n      query: encodeURI(\"$filter=_user_id eq '57039384a74e1fed39b1663b460b7e7f51f99bee'&$orderby=_created_at desc\")\n    },\n  ]);\n\n  const userMap: Record<string, User> = useMemo(() => userList.reduce((acc: any, cur: User) => ({\n    ...acc,\n    [cur._user_id]: acc[cur._user_id] || cur,\n  }), {}), [userList]);\n\n  const imageMap: Record<string, Image[]> = useMemo(() => imageList.reduce((acc: any, cur: Image) => ({\n    ...acc,\n    [cur.bind_text_id]: [...(acc[cur.bind_text_id] || []), cur],\n  }), {}), [imageList]);\n\n  const likeMap: Record<string, Like> = useMemo(() => likeList.reduce((acc: any, cur: Like) => ({\n    ...acc,\n    [cur.id]: cur,\n  }), {}), [likeList]);\n\n  const loadUser = () => {\n    fetch(`${end_point}/user/all?$orderby=_created_at desc`)\n      .then(httpToJson)\n      .then(setUserList);\n  };\n\n  const loadImages = async () => {\n    const loadImagesLimit = async (limit: number) => {\n      const newImageList: Image[] = await fetch(`${end_point}/image/all?$orderby=_created_at desc&$limit=${limit}`).then(httpToJson);\n\n      if(imageList.length ===0){\n        setImageList(newImageList);\n        return;\n      }\n\n      const newImageListIndex = newImageList.findIndex(newImage => newImage.id === imageList[0]?.id);\n      if(newImageListIndex !== -1){\n        setImageList(prev => [...newImageList.slice(0, newImageListIndex), ...prev]);\n        return;\n      }\n      await loadImagesLimit(limit + 100);\n    }\n    await loadImagesLimit(20);\n  };\n\n  const loadLikes = () => {\n    fetch(`${end_point}/like/all`)\n      .then(httpToJson)\n      .then(setLikeList);\n  };\n\n  const handleSubmit = async ({text, replyToUserId, replyToTextId, files}: ComposeValue) => {\n    const params = {\n      text,\n      ...(replyToUserId ? {in_reply_to_user_id: replyToUserId}: {}),\n      ...(replyToTextId ? {in_reply_to_text_id: replyToTextId}: {}),\n    };\n    const postTextRes: Return = await fetch(`${end_point}/text`, {\n      method: \"POST\",\n      headers: {Authorization: \"HelloWorld\"},\n      body: JSON.stringify(params)\n    }).then(httpToJson);\n    if (files) {\n      for (const file of files) {\n        const base64 = await asyncConvertBase64(file);\n        if (!base64) {\n          console.error('画像が大きすぎます');\n          setNotificationContent({text: '画像が大きすぎます', type: \"error\"});\n          continue;\n        }\n        await uploadImages({base64s: [base64], bindTextId: postTextRes.id});\n      }\n      await loadImages();\n    }\n\n    setLoadLogTrigger(prev => prev+1);\n  };\n\n  useEffect(() => {\n    loadUser();\n    setInterval(loadUser, 60_000 * 10);//10分\n\n    loadImages();\n    setInterval(loadImages, 10_000);\n\n    loadLikes();\n    setInterval(loadLikes, 60_000);//1minute\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n\n  useEffect(() => {\n    if(previewImages.images.length){\n      setOpenPreviewImagesOverlay(true);\n    }\n  }, [previewImages]);\n\n  return (\n    <StyledMain>\n      <SetPreviewImagesContext.Provider value={setPreviewImages}>\n        <LoadImagesContext.Provider value={loadImages} >\n          <ImageMapContext.Provider value={{imageMap, likeMap, userMap, setNotificationContent }}>\n            <ComposeContext.Provider value={{composeValue, setComposeValue}}>\n              <Compose value={composeValue} onChange={setComposeValue} onSubmit={handleSubmit} userList={userList} />\n              <div className=\"flex\">\n                {painValues.map((list, index) => (\n                  <Logs\n                    key={list.name}\n                    value={list}\n                    loadLogTrigger={loadLogTrigger}\n                    onChangePainValue={value => {\n                      setPainValues(prev => {\n                        const newList = [...prev];\n                        newList[index] = value;\n                        return newList\n                      })\n                    }}\n                  />\n                ))}\n              </div>\n            </ComposeContext.Provider>\n          </ImageMapContext.Provider>\n        </LoadImagesContext.Provider>\n      </SetPreviewImagesContext.Provider>\n      <PreviewImagesOverlay\n        open={openPreviewImagesOverlay}\n        onClose={() => setOpenPreviewImagesOverlay(false)}\n        images={previewImages.images}\n        index={previewImages.index}\n      />\n      <NotificationBar content={notificationContent} />\n    </StyledMain>\n  );\n};\n\nconst StyledMain = styled.div`\n  ::-webkit-scrollbar {\n    display:none;\n  }\n`;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\nimport reportWebVitals from './reportWebVitals';\nimport { MainPage } from \"./MainPage\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <Switch>\n        <Route exact path=\"/\">\n          <MainPage />\n        </Route>\n      </Switch>\n    </BrowserRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}